<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preload" href="/favicon.svg" as="image" fetchpriority="high" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <meta http-equiv="x-dns-prefetch-control" content="on" />
    <title>DREWEAVE - Student Recovery App</title>
  </head>
  <body>
    <div id="root"></div>
    <script>
      (function(){
        function showOverlay(msg){
          try{
            var el=document.createElement('div');
            el.style.position='fixed';
            el.style.inset='0';
            el.style.background='linear-gradient(135deg,#a7c5f9 0%,#e0f3ff 100%)';
            el.style.display='flex';
            el.style.alignItems='center';
            el.style.justifyContent='center';
            el.style.zIndex='99999';
            el.innerHTML='<div style="max-width:320px;width:90%;padding:16px;border-radius:20px;background:rgba(255,255,255,.75);backdrop-filter:saturate(180%) blur(12px);color:#0a3a67;font-size:14px;line-height:1.5;"><div style="font-size:16px;font-weight:700;margin-bottom:8px;">页面加载失败</div><div style="margin-bottom:12px;">'+(msg||'请检查网络连接或切换至WiFi后重试')+'</div><div style="display:flex;gap:8px;">'+
            '<button id="reload_btn" style="flex:1;padding:10px 12px;border-radius:12px;background:#2563eb;color:#fff;border:none;">重试</button>'+
            '<button id="login_btn" style="flex:1;padding:10px 12px;border-radius:12px;background:#10b981;color:#fff;border:none;">去登录</button>'+
            '</div></div>';
            document.body.appendChild(el);
            var r=document.getElementById('reload_btn');
            if(r) r.onclick=function(){ try{ location.reload() }catch{}}
            var l=document.getElementById('login_btn');
            if(l) l.onclick=function(){ try{ location.href='/login' }catch{}}
          }catch{}
        }
        window.addEventListener('error',function(e){
          try{ console.debug('runtime_error',e.error||e.message||'') }catch{}
          showOverlay('网络或浏览器兼容性问题导致脚本错误');
        });
        window.addEventListener('unhandledrejection',function(e){
          try{ console.debug('unhandled_rejection',e.reason||'') }catch{}
          showOverlay('网络请求失败或超时');
        });
      })();
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>